<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cycleCalendrier</title>
    <link rel="stylesheet" href="evo-calendar.midnight-blue.min.css" />
    <link rel="stylesheet" href="evo-calendar.min.css" />
    <link rel="stylesheet" href="index.css" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.js"></script>
    <script>
      $(document).ready(function () {
        // Open modal on page load

        // Close modal on button click
        $(".btn").click(function () {
          $("#myModal").modal("hide");
        });
      });
    </script>
  </head>
  <body>
    <div class="hero">
      <div id="calendar"></div>
      <div class="bs-example">
        <div
          id="myModal"
          class="modal fade"
          tabindex="-1"
          style="margin-top: 165px"
        >
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header" style="display: none">
                <h5 class="modal-title"></h5>
                <button type="button" class="close" data-dismiss="modal">
                  &times;
                </button>
              </div>
              <div class="modal-body">
                <p>Votre Cycle menstruel.</p>
                <div class="form-check form-switch" style="margin-bottom: 19px">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    role="switch"
                    id="flexSwitchCheckDefault"
                    style="margin-bottom: 10px"
                  />
                  <label class="form-check-label" for="flexSwitchCheckDefault"
                    >La date de la fin de votre cycle</label
                  >
                </div>
                <input type="date" name="" id="laDuréeDuCycle" />
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-primary"
                  id="validerJourCycle"
                >
                  Valider
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="evo-calendar.min.js"></script>
    <script>
      // Initialize evo-calendar in your script file or an inline <script> tag
      $(document).ready(function () {
        // activé le div choix fin cycle
        var validerJourCycle = document.getElementById("validerJourCycle");
        $("#calendar").evoCalendar({
          theme: "Midnight Blue",
        });
        $("#calendar").on("selectDate", function (event, newDate, oldDate) {
          $("#myModal").modal("show");
          // getActiveDate
          var active_date = $("#calendar").evoCalendar("getActiveDate");
          var now = new Date();
          console.log("active_date " + active_date + " et " + now);
          if (active_date != now) {
            $("#myModal").modal("hide");
          }
        });

        validerJourCycle.addEventListener("click", function () {
          var now = new Date();
          var NumberlaDuréeDuCycle =
            document.getElementById("laDuréeDuCycle").value;
          function addDaysToDate(date, days) {
            var res = new Date(date);
            res.setDate(res.getDate() + days);
            return res;
          }

          var now = new Date(); // Augest 20, 2020
          //diff entre jour
          var now = new Date();
          var date2 = new Date(NumberlaDuréeDuCycle);
          var Diff_temps = date2.getTime() - now.getTime();
          var Diff_jours = Diff_temps / (1000 * 3600 * 24);
          console.log(
            "Le nombre de jours entre les deux dates est de " +
              Math.round(Diff_jours) +
              " jours"
          );
          var tab = [];
          tab.push(Math.round(Diff_jours));

          console.log(tab);
          var momm = moment(new Date(NumberlaDuréeDuCycle))
            .subtract(14, "days")
            .calendar();
          var momm1 = moment(new Date(NumberlaDuréeDuCycle))
            .subtract(15, "days")
            .calendar();
          var momm2 = moment(new Date(NumberlaDuréeDuCycle))
            .subtract(16, "days")
            .calendar();
          var momm3 = moment(new Date(NumberlaDuréeDuCycle))
            .subtract(17, "days")
            .calendar();
          console.log(
            "nous sommes en route mes frères " +
              NumberlaDuréeDuCycle +
              " et " +
              momm
          );

          $("#calendar").evoCalendar("addCalendarEvent", [
            {
              id: "kNybja6",
              name: "Début de mon cycle",
              badge: "02/13 - 02/15", // Event badge (optional)
              description:
                "Votre cycle menstruel est de " +
                Math.round(Diff_jours) +
                " jours",
              date: now,
              type: "birthday",
              color: "#63d867",
            },
            {
              id: "kNybja6786786OI",
              name: "Ovulation",
              badge: "02/13 - 02/15", // Event badge (optional)
              description: "Lorem ipsum dolor sit..",
              date: momm,
              type: "birthday",
              color: "#f88222",
            },
            {
              id: "kNybja6786234ER",
              name: "Ovulation",
              badge: "02/13 - 02/15", // Event badge (optional)
              description: "Lorem ipsum dolor sit..",
              date: momm1,
              type: "birthday",
              color: "#f88222",
            },
            {
              id: "kNybja678667676?",
              name: "Ovulation",
              badge: "02/13 - 02/15", // Event badge (optional)
              description: "Lorem ipsum dolor sit..",
              date: momm2,
              type: "birthday",
              color: "#f88222",
            },
            {
              id: "kNybja6786§§§§",
              name: "Ovulation",
              badge: "02/13 - 02/15", // Event badge (optional)
              description: "Lorem ipsum dolor sit..",
              date: momm3,
              type: "birthday",
              color: "#f88222",
            },
          ]);
        });
      });
    </script>
  </body>
</html>
